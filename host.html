<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Host | Buzzer</title>
    <link rel='stylesheet' href='css/host.css' />
    <script src='bower_components/jquery/dist/jquery.min.js'></script>
    <script src='node_modules/socket.io-client/socket.io.js'></script>
    <script>
        var socket = io('/host');
        var guessingPlayer;
        var ready = true;

        $(document).ready(function() {
            $('body').on('click', '.responseButton', function() {
                $("#buttons").hide();
                $("#continueButton").show();
                $('.active').removeClass('active')
                if ($(this).attr('id') == 'correct') {
                    socket.emit('success', guessingPlayer);
                    $(document.getElementById(guessingPlayer)).addClass('success');
                } else {
                    socket.emit('failure', guessingPlayer);
                    $(document.getElementById(guessingPlayer)).addClass('failure');
                }
                guessingPlayer = '';
            });
            $('body').on('click', '#continueButton', function() {
                $("#continueButton").hide();
                $('#playerList li').removeClass('success').removeClass('failure');
                ready = true;
                socket.emit('continue');
            });
            socket.on('playerJoin', function(id, name) {
                $('#playerList').append('<li id=' + id + '>' + name + '</li>');
            });

            socket.on('playerLeave', function(id) {
                $(document.getElementById(id)).remove();
            });

            socket.on('playerGuess', function(id) {
                if(ready){
                    $(document.getElementById(id)).addClass('active');
                    $('#buttons').show();
                    guessingPlayer = id;
                    socket.emit('acceptedGuess', id);
                    ready = false;
                }
            });
            socket.on('roomID', function(room) {
                $('#room').text(room);
            });
        });
    </script>
</head>

<body>
    <div id='content'>
        <span id='room'></span>
        <div id="buttons">
            <button id="correct" class='responseButton'>Correct</button>
            <button id="incorrect" class='responseButton'>Incorrect</button>
        </div>
        <button id='continueButton'>Continue</button>
        <ul id='playerList'></ul>
    </div>
</body>

</html>
